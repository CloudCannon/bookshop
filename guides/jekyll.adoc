= Jekyll Bookshop
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]
:toc:
:toc-placement!:

toc::[]

== Quick start
To jump right into using Bookshop on a Jekyll site, check out the link:https://github.com/CloudCannon/jekyll-bookshop-starter[Jekyll Bookshop Starter] 

== Bookshop Configuration

Reference the Jekyll engine in your Bookshop configuration file. Bookshop expects this package to be installed in your working directory, usually your site, _not_ in your Bookshop project.
.*bookshop.config.js*
```javascript
module.exports = {
    engines: {
        "@bookshop/jekyll-engine": {}
    }
}
```

.*command*
```bash
cd site/
npm i -D @bookshop/jekyll-engine
# or
yarn add -D @bookshop/jekyll-engine
```

== Jekyll Configuration

To use Bookshop with Jekyll, the primary dependency is the `jekyll-bookshop` gem.

.*Gemfile*
```ruby
group :jekyll_plugins do
  gem "jekyll-bookshop"
end
```

Within your Jekyll config, specify the path to your Bookshop project. 

TIP: If you specify multiple paths, the components will be merged.

TIP: Paths that don't exist will be skipped. If you specify local and production paths, the one that exists will be used.

.*_config.yml*
```yaml
plugins:
  - jekyll-bookshop

bookshop_locations:
  - ../component-library
```

== Writing components

Let's look at an example `button.jekyll.html` file.
```
components/
└─ button/
   └─ button.jekyll.html
```
These files are namespaced for the static site generator when the filetype is ambiguous, which is why the file is `button.jekyll.html` and not `button.html`. Beyond the naming convention, these files are what you would expect when working with Jekyll. Our `button.jekyll.html` file might look like:
```hbs
<a class="c-button" href="{{ include.link_url }}">{{ include.text }}</a>
```
This looks like a normal Jekyll include because... it is. While Bookshop provides developer tooling, the job of jekyll-bookshop is to tell Jekyll where to find component files. Loading and parsing these files goes through the normal Jekyll include flow.

TIP: The `@bookshop/init` package helps create component structures for you. Running `npx @bookshop/init --component button` would create the button structure needed for Jekyll.

== Using components

To use components directly in a template, use the `{% bookshop %}` tag like you would an include.

.*index.html*
```liquid
...
<div class="hero">
  {% bookshop hero title=page.title image=page.image %}
  {% bookshop button label=page.cta_text link_url=page.cta_url %}
</div>
...
```

Inside a loop, a variable can be used to render the component from a given key:

.*index.html*
```liquid
---
components:
  - _bookshop_name: hero
    title: "Hello World"
    image: /image.png
  - _bookshop_name: button
    cta_text: "Get Started"
    link_url: /
---
<div class="hero">
  {% for props in page.components %}
    {% bookshop {{props._bookshop_name}} bind=props %}
  {% endfor %}
</div>
```

TIP: _Bookshop tags can use the `bind=` parameter, which works like the spread operator in Javascript. Here, all keys within the object `props` are unwrapped and passed to the component directly. If you're used to a framework like Svelte, this is the equivalent of `<Component {...props} />`_

TIP: _The structures generated by Bookshop for CloudCannon include the `_bookshop_name` field for you, so this can be used to render components dynamically_

== Using Bookshop Includes

Bookshop includes can be placed in the `shared/jekyll` directory. i.e:
```text
component-library/
├─ components/
└─ shared/
  └─ jekyll/
    └─ helper.jekyll.html
```

This can then be included using the `bookshop_include` tag:
```liquid
  {% bookshop_include helper lorem="ipsum" %}
```

This is otherwise a standard Jekyll include, with the extra feature that it can be used anywhere within your Jekyll site _or_ your components.

== Importing styles

To import Bookshop styles in Jekyll, the plugin provides the tag `{% bookshop_scss %}` to be used in your main SCSS file. For example:

.*assets/main.scss*
```text
---
# Front matter dashes for Jekyll to process the file
---

{% bookshop_scss %} // Import all bookshop styles

```

This bundles all Bookshop SCSS files into the Jekyll Sass pipeline.

== Component Library

Setting up the component library is fairly framework agnostic, so following the steps in the link:browser.adoc[Component Browser Guide] should see you on your way.

== Live Editing

Bookshop experimentally supports automatic live previews when editing on CloudCannon. +
In Jekyll, this can be added with the `cloudcannon-jekyll-bookshop` gem.


.*Gemfile*
```ruby
group :jekyll_plugins do
  gem "jekyll-bookshop"
  gem "cloudcannon-jekyll-bookshop"
end
```

.*_config.yml*
```yaml
plugins:
  - jekyll-bookshop
  - cloudcannon-jekyll-bookshop

bookshop_locations:
  - ../component-library
```

With that dependency installed, follow the instructions in the link:live-editing.adoc[Live Editing Guide]

