= Hugo Bookshop
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]
:toc:
:toc-placement!:

toc::[]

IMPORTANT: Hugo support should be treated as a semi-stable beta

== Quick start
To jump right into using Bookshop on a Hugo site, check out the link:https://github.com/CloudCannon/hugo-bookshop-starter[Hugo Bookshop Starter] 

== Hugo Configuration

To use Bookshop with Hugo, the primary dependency is the `bookshop/hugo` module. This provides the bookshop partials needed to render components on your website. This import should be placed in your **site** config.toml.

.*site/config.toml*
```toml
[[module.imports]]
path = 'github.com/cloudcannon/bookshop/hugo/v2'
```

The best workflow is then to create a new Hugo module to house your components. This can then be used across multiple websites using the Hugo module system.

.*bash*
```bash
hugo mod init github.com/example/components
```

The file structure within this components module is described in the link:conventions.adoc[Conventions Guide]

The last piece of config is adding the following mounts to the `config.toml` in your **components** module.

.*components/config.toml*
```toml
[[module.mounts]]
source = "."
target = "layouts/partials/bookshop"

[[module.mounts]]
source = "."
target = "assets/bookshop"
```

These mounts allow the `bookshop/hugo` module to locate your components.

See the link:https://github.com/CloudCannon/hugo-bookshop-starter[Hugo Bookshop Starter] for an example of how all of the above looks in practice.

== Writing components

Let's look at an example `button.hugo.html` file.
```
components/
└─ button/
   └─ button.hugo.html
```
These files are namespaced for the static site generator when the filetype is ambiguous, which is why the file is `button.hugo.html` and not `button.html`. Beyond the naming convention, these files are what you would expect when working with Hugo. Our `button.hugo.html` file might look like:
```go
<a class="c-button" href="{{ .link_url }}">{{ .text }}</a>
```
This looks like a normal Hugo include because... it is. While Bookshop provides developer tooling, the job of the `bookshop/hugo` module is to tell Hugo where to find component files. Loading and parsing these files goes through the normal Hugo partial flow.

TIP: The `@bookshop/init` package helps create component structures for you. Running `npx @bookshop/init --component button` would create the button structure needed for Hugo.

== Using components

To use components directly in a template, use the `bookshop` partial with the `components` syntax.

.*index.html*
```html
...
<div class="hero">
  {{ partial "bookshop" (dict "component" "hero" "title" .Params.title "image" .Params.image) }}
  {{ partial "bookshop" (dict "component" "button" "label" .Params.cta_text "link_url" .Params.cta_url) }}
</div>
...
```

This tag expects a dict containing a `component` field that references the Bookshop key of a component, as well as any fields to pass to the partial.

To render a list of components, you can pass a structure or an array of structures to the `bookshop` partial:

.*index.html*
```html
---
components:
  - _bookshop_name: hero
    title: "Hello World"
    image: /image.png
  - _bookshop_name: button
    cta_text: "Get Started"
    link_url: /
---
<div class="hero">
  {{ partial "bookshop" .Params.components }}
</div>
```

This tag expects either an object containing a `_bookshop_name` key, or an array of objects containing `_bookshop_name` keys.

TIP: _The structures generated by Bookshop for CloudCannon include the `_bookshop_name` field for you. If you're not using structures you will need to add the `_bookshop_name` key by hand_

== Using Bookshop Partials

Bookshop partials can be placed in the `shared/hugo` directory. i.e:
```text
component-library/
├─ components/
└─ shared/
  └─ hugo/
    └─ helper.hugo.html
```

This can then be included using the `bookshop` partial with the `partial` syntax:
```html
  {{ partial "bookshop" (dict "partial" "helper" "lorem" "ipsum") }}
```

This tag expects a dict containing a `partial` field that references the Bookshop key of a partial, as well as any fields to pass to the partial.

This is otherwise a standard Hugo partial, with the extra feature that it can be used anywhere within your Hugo site _or_ your components.

== Importing styles

To import Bookshop styles in Hugo, the plugin provides a `bookshop_scss` partial, which returns a slice of all SCSS resources in your bookshop. This can then be used as such:

.*baseof.html*
```html
{{ $bookshop_scss_files := partial "bookshop_scss" . }}
{{ $scss := $bookshop_scss_files | resources.Concat "css/bookshop.css" | resources.ToCSS | resources.Minify | resources.Fingerprint }}
<link rel="stylesheet" href="{{ $scss.Permalink }}">
```
