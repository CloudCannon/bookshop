{{/*
    Renders a Bookshop component, or an array of Bookshop components.

    To render a single structure object, or an array of structure objects,
    the object or slice is expected to be passed in directly.

    To render a single component:
    { 
        component: String, # The bookshop name of a component to render
        ... # any data to pass to the component
    }

    To render a single partial:
    { 
        partial: String, # The bookshop name of a partial to render
        ... # any data to pass to the include
    }
*/}}

{{- $is_structures := reflect.IsSlice . -}}
{{- $is_component := false -}}
{{- $is_partial := false -}}

{{- if reflect.IsMap . -}}
    {{- $is_structures = isset . "_bookshop_name" -}}
    {{- $is_component = isset . "component" -}}
    {{- $is_partial = isset . "partial" -}}
{{- end -}}

{{- if $is_structures -}}
    {{- partial "_bookshop/helpers/render_direct_structures" . -}}
{{- else if $is_component -}}
    {{- $component_params := dict "_bookshop_name" .component -}}
    {{- $component := merge . $component_params -}}
    {{- partial "_bookshop/helpers/component" (dict "component" $component) -}}
{{- else if $is_partial -}}
    {{- $partial_params := dict "_bookshop_name" .partial -}}
    {{- $partial := merge . $partial_params -}}
    {{- partial "_bookshop/helpers/partial" (dict "partial" $partial) -}}
{{- else -}}
    {{- partial "_bookshop/errors/bad_bookshop_tag" -}}
{{- end -}}
